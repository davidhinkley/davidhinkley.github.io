"use strict";(self.webpackChunkphoto_gallery_client=self.webpackChunkphoto_gallery_client||[]).push([[86],{86:(e,t,a)=>{a.r(t),a.d(t,{default:()=>c});var s=a(43),l=a(216),r=a(213),i=a(493),o=a(641),n=a(579);const c=()=>{const e=(0,l.Zp)(),[t,a]=(0,s.useState)({title:"",description:"",category:"",attribution:""}),[c,d]=(0,s.useState)(!1),[m,h]=(0,s.useState)(null),[p,x]=(0,s.useState)(null),[u,b]=(0,s.useState)(null),[g,y]=(0,s.useState)(!1),[j,N]=(0,s.useState)(null),[v,f]=(0,s.useState)(null),w=e=>{a({...t,[e.target.name]:e.target.value})};return(0,n.jsxs)("div",{className:"max-w-2xl mx-auto",children:[(0,n.jsx)("h1",{className:"text-3xl font-bold text-gray-800 mb-6",children:"Upload Photo"}),j&&(0,n.jsx)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4",children:j}),(0,n.jsxs)("form",{onSubmit:async a=>{if(a.preventDefault(),!m)return void N("Please select a file to upload");y(!0),N(null);const s=new FormData;s.append("photo",m),s.append("title",t.title),s.append("description",t.description),s.append("category",t.category),c&&t.attribution&&s.append("attribution",t.attribution);try{const t=await r.A.post("/api/photos",s,{headers:{"Content-Type":"multipart/form-data"}});e(`/photos/${t.data.id}`)}catch(j){var l,i;console.error("Error uploading photo:",j),N((null===(l=j.response)||void 0===l||null===(i=l.data)||void 0===i?void 0:i.message)||"Error uploading photo"),y(!1)}},className:"bg-white rounded-lg shadow-md overflow-hidden",children:[(0,n.jsxs)("div",{className:"p-6",children:[(0,n.jsxs)("div",{className:"mb-6",children:[(0,n.jsx)("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"photo",children:"Photo"}),(0,n.jsxs)("div",{className:"border-2 border-dashed border-gray-300 rounded-md p-6 text-center",children:[u?(0,n.jsxs)("div",{className:"mb-4",children:[(0,n.jsx)("img",{src:u,alt:"Preview",className:"max-h-64 mx-auto"}),v&&(0,n.jsxs)("div",{className:"mt-2 text-sm text-gray-600 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 p-2 rounded",children:[(0,n.jsxs)("p",{children:["Original: ",v.originalSize," MB"]}),(0,n.jsxs)("p",{children:["Compressed: ",v.compressedSize," MB"]}),(0,n.jsxs)("p",{children:["Saved: ",v.savings,"% of original size"]})]})]}):(0,n.jsxs)("div",{className:"text-gray-500 mb-4",children:[(0,n.jsx)(i.A,{className:"h-12 w-12 mx-auto text-gray-400"}),(0,n.jsx)("p",{children:"Drag and drop your photo here, or click to select"}),(0,n.jsx)("p",{className:"text-xs mt-2",children:"Images will be automatically compressed for optimal performance"})]}),(0,n.jsx)("input",{type:"file",id:"photo",name:"photo",accept:"image/*",onChange:async e=>{const t=e.target.files[0];if(t){x(t);const e=new FileReader;e.onloadend=()=>{b(e.result)},e.readAsDataURL(t);try{const e={maxSizeMB:1,maxWidthOrHeight:1920,useWebWorker:!0,initialQuality:.8};y(!0);const a=await(0,o.A)(t,e),s=t.size/1048576,l=a.size/1048576,r=((s-l)/s*100).toFixed(1);f({originalSize:s.toFixed(2),compressedSize:l.toFixed(2),savings:r}),h(a),y(!1)}catch(j){console.error("Error compressing image:",j),h(t),N("Image compression failed. The original image will be used."),y(!1)}}},className:"hidden"}),(0,n.jsx)("button",{type:"button",onClick:()=>document.getElementById("photo").click(),className:"btn btn-secondary",children:u?"Change Photo":"Select Photo"})]})]}),(0,n.jsxs)("div",{className:"mb-4",children:[(0,n.jsx)("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"title",children:"Title"}),(0,n.jsx)("input",{type:"text",id:"title",name:"title",value:t.title,onChange:w,className:"input",required:!0})]}),(0,n.jsxs)("div",{className:"mb-4",children:[(0,n.jsx)("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"category",children:"Category"}),(0,n.jsx)("input",{type:"text",id:"category",name:"category",value:t.category,onChange:w,className:"input",placeholder:"e.g. nature, portrait, architecture"})]}),(0,n.jsxs)("div",{className:"mb-4",children:[(0,n.jsx)("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"description",children:"Description"}),(0,n.jsx)("textarea",{id:"description",name:"description",value:t.description,onChange:w,className:"input h-32",placeholder:"Tell us about your photo..."})]}),(0,n.jsx)("div",{className:"mb-4",children:(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("input",{type:"checkbox",id:"showAttribution",checked:c,onChange:()=>d(!c),className:"mr-2"}),(0,n.jsx)("label",{className:"text-gray-700 text-sm font-bold",htmlFor:"showAttribution",children:"Attribution"})]})}),c&&(0,n.jsxs)("div",{className:"mb-4",children:[(0,n.jsx)("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"attribution",children:"Attribution"}),(0,n.jsx)("textarea",{id:"attribution",name:"attribution",value:t.attribution,onChange:w,className:"input h-20",placeholder:"Credit the original creator or source of this image..."})]})]}),(0,n.jsx)("div",{className:"bg-gray-50 px-6 py-4",children:(0,n.jsx)("button",{type:"submit",className:"btn btn-primary w-full",disabled:g,children:g?(0,n.jsxs)("span",{className:"flex items-center justify-center",children:[(0,n.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,n.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,n.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Uploading..."]}):"Upload Photo"})})]})]})}}}]);
//# sourceMappingURL=86.3a9c7329.chunk.js.map